import logging
import numpy as np
from src.model_utils import run_single_model
from src.plot_utils import *
import src.model_config as model_config

logging.basicConfig(level=logging.INFO, format='%(asctime)s %(levelname)s %(funcName)s: %(message)s')

fig, axes = plt.subplots(ncols=1, nrows=3, sharex=True, figsize=(5, 13))

plt.subplots_adjust(hspace=0.05)

result_dict_list = [
    run_single_model(model_config.guides_without_icon, model_config.logistic_l1_model_no_icon),
    run_single_model(model_config.guides_with_icon_ohe, model_config.logistic_l1_model_ohe_icon)
]

plot_models_roc_axes(ax=axes[0],
    model_names=map(lambda x: 'AUC=%4.3f' % x['roc']['auc'], result_dict_list),
    styles=['r-', 'k-'],
    result_dict_list=result_dict_list)
add_inner_title(title='(a) Logistic Regression with L1', loc=3, ax=axes[0], size=16)
axes[0].legend(loc='center right')

result_dict_list = [
    run_single_model(model_config.guides_without_icon, model_config.logistic_l2_model_no_icon),
    run_single_model(model_config.guides_with_icon_ohe, model_config.logistic_l2_model_ohe_icon)
]
plot_models_roc_axes(ax=axes[1],
    model_names=map(lambda x: 'AUC=%4.3f' % x['roc']['auc'], result_dict_list),
    styles=['r-', 'k-'],
    result_dict_list=result_dict_list)
add_inner_title(title='(b) Logistic Regression with L2', loc=3, ax=axes[1], size=16)
axes[1].legend(loc='center right')

result_dict_list = [
    run_single_model(model_config.guides_without_icon, model_config.svc_linear_model_no_icon),
    run_single_model(model_config.guides_with_icon_ohe, model_config.svc_linear_model_ohe_icon)
]
plot_models_roc_axes(ax=axes[2],
    model_names=map(lambda x: 'AUC=%4.3f' % x['roc']['auc'], result_dict_list),
    styles=['r-', 'k-'],
    result_dict_list=result_dict_list)
add_inner_title(title='(c) Support Vector Machine', loc=3, ax=axes[2], size=16)
axes[2].legend(loc='center right')

axes[0].set_ylabel('True Positive Rate')
axes[1].set_ylabel('True Positive Rate')
axes[2].set_ylabel('True Positive Rate')
axes[2].set_xlabel('False Positive Rate')

plt.savefig('plot_roc_curves_vertical.pdf', bbox_inches='tight')


